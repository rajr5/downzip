!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.DownZip=r():e.DownZip=r()}(window,(function(){return function(e){var r={};function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var o in e)t.d(n,o,function(r){return e[r]}.bind(null,o));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=0)}([function(e,r,t){"use strict";t.r(r);var n=function(){function e(){var r=Error.call(this,"ServiceWorker is not supported.");return Object.setPrototypeOf(r,e.prototype),r}return e.prototype=Object.create(Error.prototype),e}(),o="/downzip-sw.js";function i(e,r,t,n,o,i,u){try{var a=e[i](u),c=a.value}catch(e){return void t(e)}a.done?r(c):Promise.resolve(c).then(n,o)}function u(e){return function(){var r=this,t=arguments;return new Promise((function(n,o){var u=e.apply(r,t);function a(e){i(u,n,o,a,c,"next",e)}function c(e){i(u,n,o,a,c,"throw",e)}a(void 0)}))}}function a(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var c="downzip",s=5e3,f=function(){function e(){var r,t=this;!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),this.worker=null,(r={scope:"./".concat(c,"/")},"serviceWorker"in navigator?navigator.serviceWorker.register(o,r):Promise.reject(new n)).then((function(e){console.log("[DownZip] Service worker registered successfully:",e),t.worker=e.installing||e.active})).catch((function(e){console.error("[DownZip] Service workers not loaded:",e)})),setInterval(u(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.sendMessage("TICK");case 1:case"end":return e.stop()}}),e)}))),s)}var r,t,i,f;return r=e,(t=[{key:"sendMessage",value:function(e,r,t){this.worker.postMessage({command:e,data:r},t?[t]:void 0)}},{key:"downzip",value:(f=u(regeneratorRuntime.mark((function e(r,t,n){var o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.worker){e.next=3;break}return console.error("[DownZip] No service worker registered!"),e.abrupt("return");case 3:return e.abrupt("return",new Promise((function(e,i){var u=new MessageChannel;u.port1.addEventListener("message",(function(){return e("".concat(c,"/download-").concat(r))})),u.port1.start(),o.sendMessage("INITIALIZE",{id:r,files:n,name:t},u.port2),setTimeout(i,5e3)})));case 4:case"end":return e.stop()}}),e,this)}))),function(e,r,t){return f.apply(this,arguments)})}])&&a(r.prototype,t),i&&a(r,i),e}();r.default=f}])}));